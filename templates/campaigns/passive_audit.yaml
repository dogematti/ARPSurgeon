name: "Zero-Touch Infrastructure Audit"
description: "Passive reconnaissance to build asset inventory without active scanning."
steps:
  - action: profile
    name: "Phase 1: Initial Listener (5m)"
    args:
      duration: 300
      verbose: true
      pcap_filter: "arp"

  - action: profile
    name: "Phase 2: Service Fingerprinting (10m)"
    description: "Listens for DHCP and mDNS to identify OS and Hostnames."
    args:
      duration: 600
      verbose: true
      # Capture DHCP (67) and mDNS (5353) and LLMNR (5355) and NBNS (137)
      pcap_filter: "arp or (udp and (port 67 or port 5353 or port 5355 or port 137))"

  - action: report
    name: "Generate Topology Graph"
    args:
      input: "arpsurgeon.db" # Or JSON output from profile if specified
      # Since profile writes to DB by default now, we might need a DB export step or just use the web UI.
      # But for CLI report, we usually take a file.
      # Let's assume profile writes to a file for this campaign.
      json: "audit_passive.json"
      format: "graph"
      output: "audit_topology.html"
